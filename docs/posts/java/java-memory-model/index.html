<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://akhilesh006.github.io/javaprincipal/css/frameworks.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://akhilesh006.github.io/javaprincipal/css/github.css" />
    
    <link crossorigin="anonymous" media="(prefers-color-scheme: dark)" rel="stylesheet"
        href="https://akhilesh006.github.io/javaprincipal/css/dark.css" />
    
    <meta name="viewport" content="width=device-width">
    <meta name="description"
        content="Heap Dynamic memory area and Shared among all threads of an application. When full, We get java.lang.OutOfMemoryError.
- Young Generation Area:- Eden Space: Newly created Objects goes in Eden Space.- Survivor Space: ( Two survivor space s0 &amp;amp; s1): When Eden space is filled, Miner GC is performed and all survivor object moved into survivor space.- Old/Tenured Generation Area: The remaining objects moved into Old generation which are survivor after many cycle of miner GC." />
    <meta name="keywords"
        content="java, blog, deep learning" />
    <meta name="robots" content="noodp" />
    <link rel="canonical" href="https://akhilesh006.github.io/javaprincipal/posts/java/java-memory-model/" />

    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Java Memory Model - Java Principal" />
    <meta name="twitter:description"
        content="Heap Dynamic memory area and Shared among all threads of an application. When full, We get java.lang.OutOfMemoryError.
- Young Generation Area:- Eden Space: Newly created Objects goes in Eden Space.- Survivor Space: ( Two survivor space s0 &amp;amp; s1): When Eden space is filled, Miner GC is performed and all survivor object moved into survivor space.- Old/Tenured Generation Area: The remaining objects moved into Old generation which are survivor after many cycle of miner GC." />
    <meta name="twitter:site" content="https://akhilesh006.github.io/javaprincipal/" />
    <meta name="twitter:creator" content="Akhilesh Dubey" />
    <meta name="twitter:image"
        content="https://akhilesh006.github.io/javaprincipal/">

    
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Java Memory Model - Java Principal">
    <meta property="og:description"
        content="Heap Dynamic memory area and Shared among all threads of an application. When full, We get java.lang.OutOfMemoryError.
- Young Generation Area:- Eden Space: Newly created Objects goes in Eden Space.- Survivor Space: ( Two survivor space s0 &amp;amp; s1): When Eden space is filled, Miner GC is performed and all survivor object moved into survivor space.- Old/Tenured Generation Area: The remaining objects moved into Old generation which are survivor after many cycle of miner GC." />
    <meta property="og:url" content="https://akhilesh006.github.io/javaprincipal/posts/java/java-memory-model/" />
    <meta property="og:site_name" content="Java Memory Model" />
    <meta property="og:image"
        content="https://akhilesh006.github.io/javaprincipal/">
    <meta property="og:image:width" content="2048">
    <meta property="og:image:height" content="1024">

    
    <meta property="article:published_time" content="2020-05-31 03:49:42 &#43;0530 IST" />
    

    
    

    <title>Java Memory Model - Java Principal</title>

    <link rel="icon" type="image/x-icon" class="js-site-favicon" href="https://akhilesh006.github.io/javaprincipal/images/favicon.ico">
    <meta name="theme-color" content="#1e2327">

    
    

    
</head>

<body class="env-production emoji-size-boost page-responsive page-profile">
  <div class="position-relative js-header-wrapper ">
    <span class="Progress progress-pjax-loader position-fixed width-full js-pjax-loader-bar">
        <span class="progress-pjax-loader-bar top-0 left-0" style="width: 0%;"></span>
    </span>
    <header class="Header py-lg-0 js-details-container Details flex-wrap flex-lg-nowrap p-responsive" role="banner">
        <div class="Header-item d-none d-lg-flex">
            <a class="Header-link" href="https://akhilesh006.github.io/javaprincipal/" aria-label="Homepage"
                data-ga-click="Header, go to dashboard, icon:logo">
                <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1"
                    width="32" aria-hidden="true">
                    <path fill-rule="evenodd"
                        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z" />
                </svg>
            </a>
        </div>
        <div
            class="Header-item Header-item--full flex-column flex-lg-row width-full flex-order-2 flex-lg-order-none mr-0 mr-lg-3 mt-3 mt-lg-0 Details-content--hidden">
            <div class="header-search flex-self-stretch flex-lg-self-auto mr-0 mr-lg-3 mb-3 mb-lg-0 scoped-search site-scoped-search js-site-search position-relative js-jump-to"
                role="combobox" aria-owns="jump-to-results" aria-label="Search or jump to" aria-haspopup="listbox"
                aria-expanded="false">
                <div class="position-relative">
                </div>
            </div>
        </div>
        <nav class="d-flex" aria-label="Global">
            <a class="js-selected-navigation-item Header-link py-lg-3">&nbsp;</a>
        </nav>
        <div class="Header-item Header-item--full flex-justify-center d-lg-none position-relative" style="margin-right: auto;">
            <a class="Header-link" href="https://akhilesh006.github.io/javaprincipal/" aria-label="Homepage"
                data-ga-click="Header, go to dashboard, icon:logo">
                <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1"
                    width="32" aria-hidden="true">
                    <path fill-rule="evenodd"
                        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z" />
                </svg>
            </a>
        </div>
        <div class="Header-item position-relative mr-0 d-none d-lg-flex">
            <details class="details-overlay details-reset">
                <summary class="Header-link" aria-label="View profile and more"
                    data-ga-click="Header, show menu, icon:avatar">
                    
                    <img alt="" class="avatar" src="https://www.gravatar.com/avatar/552d6799ed1bcf1732e15cc1909020c0.png?size=300" height="20" width="20">
                    
                </summary>
            </details>
        </div>
    </header>
</div>

<div id="start-of-content" class="show-on-focus"></div>
<div id="js-flash-container">
</div>

  
<div class="application-main " data-commit-hovercards-enabled="">
    <div itemscope="" itemtype="http://schema.org/SoftwareSourceCode" class="">
        <main>
            <div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav pt-0 pt-lg-4 ">
                <div class="repohead-details-container clearfix container-lg p-responsive d-none d-lg-block">
                    <div class="mb-3 d-flex">
                        <h1 class="public css-truncate float-none flex-auto width-fit pl-0">
                            <a class="avatar mr-1" href="https://akhilesh006.github.io/javaprincipal/about/">
                                

                                <img src="https://www.gravatar.com/avatar/552d6799ed1bcf1732e15cc1909020c0.png?size=300" width="26" height="26">
                                
                            </a>
                            <span class="author"><a href="https://akhilesh006.github.io/javaprincipal/">Akhilesh Dhar Dubey</a></span>
                            <span class="path-divider">/</span>
                            <strong itemprop="name" class="css-truncate-target" style="max-width: 410px"><a
                                    href="https://akhilesh006.github.io/javaprincipal/posts/java/java-memory-model/">Java Memory Model</a></strong>

                            <div class="d-block text-small text-gray">
                                Created <time-ago datetime="2020-05-31" class="no-wrap"
                                    title="Created at 2020/05/31">
                                    2020-05-31</time-ago>
                                <span class="file-info-divider"></span>
                                Modified <time-ago datetime="2020-05-31" class="no-wrap"
                                    title="Modified  at 2020/05/31">
                                    2020-05-31</time-ago>
                            </div>
                        </h1>
                    </div>
                </div>




            </div>
            <div class="container-lg clearfix new-discussion-timeline experiment-repo-nav  p-responsive">
                <div class="repository-content ">
                    <div class="Box mt-3 position-relative">
                        <div class="Box-header py-2 d-flex flex-column flex-shrink-0 flex-md-row flex-md-items-center">
                            <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                                643 Words
                                
                            </div>
                        </div>

                        <div id="readme" class="Box-body readme blob instapaper_body js-code-block-container">
                            <article class="markdown-body entry-content p-3 p-md-6" itemprop="text"><h3 id="heap">Heap</h3>
<p>Dynamic memory area and Shared among all threads of an application. When full, We get java.lang.OutOfMemoryError.</p>
<p><img src="https://akhilesh006.github.io/javaprincipal/jvm_memory.png" alt="JVM Memory Model"></p>
<pre><code>- Young Generation Area:
    - Eden Space: Newly created Objects goes in Eden Space.
    - Survivor Space: ( Two survivor space s0 &amp; s1): When Eden space is filled, 
        Miner GC is performed and all survivor object moved into survivor space.
- Old/Tenured Generation Area: 
    The remaining objects moved into Old generation which are survivor after 
    many cycle of miner GC. Major GC is performed when Old generation is full.
</code></pre>
<h3 id="permanent-generationpermgen">Permanent Generation(PermGen):</h3>
<p>PermGen is not part of Heap Memory area. It contains Application&rsquo;s metadeat i.e. classes and methods&rsquo;s description for JVM.</p>
<h3 id="method-area--class-area">Method Area / Class Area:</h3>
<p>Shared among all threads of an application. Also called PremGen before Java 8, It contains classes structure, constant pool, static method, static variable, constant, method codes and constructor.</p>
<h3 id="memory-pool">Memory Pool:</h3>
<p>String pool comes under memory pool area. It can belongs to heap or PermGen area depending upon Memory Manager implementation.</p>
<h3 id="runtime-constant-pool">Runtime Constant Pool:</h3>
<p>It contains class specific runtime constant of a class and static method, comes under method area.</p>
<h3 id="stack">Stack:</h3>
<p>Static memory area and constant area, Generated for each thread, When full, We get StackOverflowError, It keeps method reference, local variables of method including argument variable and reference to local object created inside method.</p>
<h3 id="caching">Caching:</h3>
<p>(Byte, Character, Integer, Short, Long): Will Discuss it later.</p>
<h3 id="program-counter-register">Program Counter Register:</h3>
<p>It is generated for each thread and it stores current instruction executed by thread.</p>
<h3 id="native-method-stack">Native Method Stack:</h3>
<p>Shared among all threads, Same as stack, but used for native method which are outside of Java.</p>
<h4 id="changes-done-in-memory-model-of-jvm-after-java-8">Changes done in Memory Model of JVM: After Java 8</h4>
<p><code>PermGen kicked-off and MetaSpace kicked-in</code></p>
<ul>
<li>Class meta-data, interned Strings and class static variables will be moved from the permanent generation to either the Java heap or native memory.</li>
<li>Java8 implementation move Class meta-data in native heap called MetaSpace and move interned Strings and class statics to the Java heap.</li>
<li>By default metaspace is unlimited and GC happens after 16 MB. its limit is specified with MaxMetaspaceSize. GC internally maintains what we call as the high-water-mark for the metaspace at which collections for the Metaspace are invoked, and it gets initialized with the value specified with MetaspaceSize. The HWM value is lowered or raised depending upon the free space after a GC.</li>
<li>The value of MaxMetaspaceFreeRatio determines how much maximum free space should be available after a GC. If the committed space available after a GC is more than MaxMetaspaceFreeRatio value, then the HWM is lowered.</li>
<li>The code for the permanent generation in the Hotspot JVM will be removed.</li>
</ul>
<p>Each Thread contains:</p>
<ul>
<li>Stack,</li>
<li>Program Counter(PC) register</li>
<li>Native Stack</li>
</ul>
<p>Shared Things among all thread:</p>
<ul>
<li>Heap</li>
<li>PermGen/ Class Area/ Method Area</li>
</ul>
<p>Each Object contains:</p>
<ul>
<li>Monitor</li>
<li>Wait Set</li>
</ul>
<h3 id="escape-analysis-ea">Escape Analysis (EA):</h3>
<p>It is a tool that the JIT compiler used to check the scope of the newly created object and decide weather the object will be placed in a heap or stack.</p>
<p>There are three type of escape states objects:</p>
<ul>
<li>NoEscape – When the object is not visible outside of the current method or thread.</li>
<li>ArgEscape – When the object is passed to a method by argument and is not visible outside of the current method or other threads.</li>
<li>GlobalEscape – When the object is visible by outside of the method or the thread, e.g when a object is returned from a method or is declared static.</li>
</ul>
<p>If the object is NoEscape, It will not be kept in Heap area, Instead it will reside in Stack area.</p>
<p>If the object is NoEscape or ArgEscape, JIT compiler can revove the locking and synchronization technique to make it fast.
e.g. If a StringBuffer is declare inside a method body It will be called NoEscape object, and JIT compile will remove locking and synchronization check on its object.</p>
<p><a href="https://blogs.oracle.com/jonthecollector/presenting-the-permanent-generation">Creation of PermGen 2006</a></p>
<p><a href="https://blogs.oracle.com/poonam/about-g1-garbage-collector,-permanent-generation-and-metaspace">Removal of PermGen 2014</a></p>
</article>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>


  <div class="footer container-lg width-full p-responsive" role="contentinfo">
    <div
        class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
        <ul
            class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
            <li class="mr-3 mr-lg-0"></a></li>
        </ul>

        <a aria-label="Homepage" title="Java Principal" class="footer-octicon d-none d-lg-block mx-lg-4"
            href="https://akhilesh006.github.io/javaprincipal/">
            <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24"
                aria-hidden="true">
                <path fill-rule="evenodd"
                    d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
                </path>
            </svg>
        </a>
        <ul
            class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
        </ul>
    </div>
    <div class="d-flex flex-justify-center pb-6">
        <span class="f6 text-gray-light"></span>
    </div>
</div>

<script crossorigin="anonymous"
    type="application/javascript" src="https://akhilesh006.github.io/javaprincipal/js/frameworks.js"></script>

<script crossorigin="anonymous"
    type="application/javascript" src="https://akhilesh006.github.io/javaprincipal/js/github-bootstrap.js"></script>
<script src="https://akhilesh006.github.io/javaprincipal/js/stop.js"></script>
<script src="https://akhilesh006.github.io/javaprincipal/js/contributions.js"></script>

</body>

</html>